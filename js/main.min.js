function hasEventInDate(e,t,a){if(e.isRecurring()){var n=e.iterator(t);if(0==n.next().compare(t))return!0}else if(-1==e.startDate.compareDateOnlyTz(t,a)&&1==e.endDate.compareDateOnlyTz(t,a)||0==e.startDate.compareDateOnlyTz(t,a)||0==e.endDate.compareDateOnlyTz(t,a))return!0;return!1}function createEventDetails(e){var t="<p>";t+="Treffpunkt: ",t+=e.location,t+="<br />",t+="Beginn: ",t+=e.startDate.toJSDate().toTimeString().substring(0,5),t+="<br />",t+="Ende: ",t+=e.endDate.toJSDate().toTimeString().substring(0,5),t+="</p>",t+="<p>",t+=e.description,t+="</p>";var a=e.attachments;for(var n in a)t+='<a href="',t+=a[n].getFirstValue(),t+='">Zusatzinfo</a>';return t}function buildCal(e){for(var t=ICAL.parse(e),a=new ICAL.Component(t),n=a.getAllSubcomponents("vevent"),r=[],i=0;i<n.length;i++)r[i]=new ICAL.Event(n[i]);var o=r.length,d=a.getFirstSubcomponent("vtimezone"),l=d.getFirstPropertyValue("tzid"),m=new ICAL.Timezone({component:d,tzid:l}),s=drcal({weekdays:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],months:["Januar","Februar","MÃ¤rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],startDay:1});s.addEventListener("drcal.renderDay",function(e){var t=document.createElement("div");t.className="daynum",t.appendChild(document.createTextNode(e.detail.date.getDate())),e.detail.element.appendChild(t);for(var a=ICAL.Time.fromJSDate(e.detail.date),n=0;o>n;n++)if(hasEventInDate(r[n],a,m)){var i=document.createElement("div");i.className="dayevent",i.setAttribute("data-toggle","modal"),i.setAttribute("data-target",".bs-example-modal-sm"),i.appendChild(document.createTextNode(r[n].summary)),e.detail.element.appendChild(i)}}),s.changeMonth(new Date),s.addEventListener("click",function(e){if("DIV"==e.target.tagName)for(var t=ICAL.Time.fromDateString(e.target.parentNode.getAttribute("date")),a=0;o>a;a++)if(hasEventInDate(r[a],t,m)&&e.target.innerHTML==r[a].summary){$(".modal-body").html(createEventDetails(r[a])),$(".modal-title").html(r[a].summary);break}});for(var c=s.querySelectorAll("button"),i=0;i<c.length;i++)c[i].classList.add("btn");document.getElementById("drcal").appendChild(s)}longlist(document.getElementById("posts"),{perPage:5}),$.get("data/termine.ics").then(buildCal);